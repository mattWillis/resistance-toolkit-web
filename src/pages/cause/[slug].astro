---
import '@assets/styles/_cause.scss';
import { type Org, orgs } from '../../data';
import { type Cause, causes } from '../../data';
import { Icon } from "astro-icon/components";
import Layout from '../../layouts/Layout.astro';
const { slug } = Astro.params;

export function getStaticPaths() {
  return [
    ...causes.map((cause) => ({
      params: {
        slug: cause.slug
      }
    }))
  ]
}

let allMatchedOrgs: Org[] = [];
const cause = causes.find((cause) => cause.slug === slug) as Cause;

orgs.map((org) => {
  org.cause.map((thisCause) => {
    if(thisCause === cause.slug) {
      allMatchedOrgs.push(org)
    }
  })
});

const globalOrgs: Org[] = allMatchedOrgs.filter((org) => org.scope === 'global');
const usOrgs: Org[] = allMatchedOrgs.filter((org) => org.scope === 'us');
---

<Layout 
title="Causes"
description='A list of causes that need your support.'
image=''
>
<header  class="max-w-6xl mx-auto" slot="header">

</header>

<section class="max-w-3xl mx-auto py-6 lg:pt-8 px-4 pb-10">
  <h1 class="resist-select-org__title">Select an Organization</h1>
  {globalOrgs.length !== 0 && 
  <h2 class="resist-org__section-title">üåç Global Organizations</h2>
    <ul class="org-list">    
      {globalOrgs.map((thisOrg) => {
        return (
        <li>
          <a class="org-link" href={`/orgs/${thisOrg.slug}?cause=${cause.slug}`}>
          
            <p class="org-title">{thisOrg.name}</p>
            <p>{thisOrg.description}</p>
            {/* <p>Website: <a href={thisOrg.url} target="_blank">{thisOrg.url}</a></p> */}
          </a>
        </li>)
      })}
    </ul>
  }
  
  <h2 class="resist-org__section-title">üá∫üá∏ U.S. Focused</h2>
  <ul class="org-list">
    {usOrgs.map((thisOrg) => {
      return (
      <li>        
        <a class="org-link" href={`/orgs/${thisOrg.slug}?cause=${cause.slug}`}>        
          <p class="org-title">{thisOrg.name}</p>
          <p>{thisOrg.description}</p>          
        </a>        
      </li>)
    })}
  </ul>
</section>
</Layout>