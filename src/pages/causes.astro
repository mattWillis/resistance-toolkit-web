---
import '../assets/styles/Causes-Page.scss';
import { type Cause, causes } from '../data';
import Layout from 'src/layouts/Layout.astro';
import type { ImageMetadata } from 'astro';
import { Image } from 'astro:assets';
import StepImg from '@assets/Step1-New.png'


export function getStaticPaths() {
  return [
    ...causes.map((cause) => ({
      params: {
        slug: cause.slug
      }
    }))
  ]
}
const sortedCauses = causes.sort((a: Cause, b: Cause) => {
  if (a.title < b.title) {
    return -1;
  }
  if (a.title > b.title) {
    return 1;
  }
  return 0;
});

const images = await import.meta.glob<{ default: ImageMetadata }>('@assets/*.{jpeg,jpg,png,gif}');
console.log(images);

---

<Layout title="Causes">
  <header class="max-w-6xl mx-auto" slot="header">
    <Image src={StepImg} alt="Pick a cause." />
    <nav aria-label="Breadcrumb" class="flex breadcrumb">
      <ol class="flex mt-3 overflow-hidden rounded-lg border border-gray-200 text-gray-600">
        <li class="flex items-center justify-center">
          <a href="/" class="flex h-10 items-center gap-1.5 bg-gray-100 px-4 transition hover:text-gray-900">
            <svg
            xmlns="http://www.w3.org/2000/svg"
            class="size-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
            />
            </svg>
            <span class="ms-1.5 text-xs font-medium"> Home </span>
          </a>
        </li>          
        <li class="relative flex items-center">
          <span
            class="absolute inset-y-0 -start-px h-10 w-4 bg-gray-100 [clip-path:_polygon(0_0,_0%_100%,_100%_50%)] rtl:rotate-180"
          >
          </span>
          <a href="/causes" class="flex h-10 items-center bg-white pe-4 ps-8 text-xs font-medium transition hover:text-gray-900" aria-current="page">
            Causes
          </a>
        </li>
        <!-- <li><a href="/informed">Next Step</a></li> -->
      </ol>
    </nav>
  </header>
  <div class="container max-w-6xl mx-auto">
    <section>
      <hr>
      <h1 class="font-bold my-2 text-center">Click on a cause to see organizations that support that cause!</h1>
      <ul class="cause-list">
        {sortedCauses.map((cause: any) => {  
          const img = cause.listImg;          
          console.log(img);
          if(!images[img]) {
            throw new Error(`"${img}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif}"`);
          }
            return (
              <li class="cause-list-item">                
                <a class="cause-link" data-cause={cause.slug} href={`/cause/${cause.slug}`}>
                  <Image class="cause-list-img" src={images[img]()} alt={cause.listImgAlt} />
                  {cause.title}
                </a>
              </li>
            )
          }        
        )}
      </ul>
      <p class="my-6 max-w-xlg mx-auto">
        <span class="font-bold italic">About This List:</span>
        The following are excellent causes that need our help. Follow the link to a cause you are passionate
        about or interested in to see a list of organizations that support that cause. The organizations 
        often have clear and concise action items to take to fight back. But they will also need our support, 
        either by donating financially or by volunteering our time.
      </p>
      <p class="my-6 text-center">
        Big thanks to <a href="https://www.advocate.com/politics/anti-donald-trump-charities" class="font-bold text-blue-500" target="_blank">Advocate</a> for inspiring and seeding this list.
      </p>
      <!-- <hr> -->
      <!-- <p class="bold">
        Picked a cause? Great! Go to <a href="/informed">step 2.</a>
      </p>       -->
    </section>
  </div>
</Layout>

